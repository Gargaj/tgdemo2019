<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<style>
			body {
				background-color: #000;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	</head>

	<body>
 		<script src="threeBuild/three.js"></script>
		<script src="threeJS/libs/inflate.min.js"></script>
		<script src="threeJS/loaders/FBXLoader.js"></script>
		<script src="threeJS/WebGL.js"></script>

		<script>
			if ( WEBGL.isWebGLAvailable() === false ) {
				document.body.appendChild( WEBGL.getWebGLErrorMessage() );
			}
			var container;
			var camera, scene, renderer;
			var clock = new THREE.Clock();
			var mixer;
			init();
			animate();
			function init() {
				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 1000 );
				camera.position.set(0, 0, 0);
				camera.rotation.set(0, 0, 0);

				scene = new THREE.Scene();
				scene.background = new THREE.Color( 0xa0a0a0 );
				scene.fog = new THREE.Fog( 0xa0a0a0, 200, 1000 );

				light = new THREE.HemisphereLight( 0xffffff, 0x444444 );
				light.position.set( 0, 200, 0 );
				scene.add( light );
				light = new THREE.DirectionalLight( 0xffffff );
				light.position.set( 0, 200, 100 );
				scene.add( light );

                loadButterfly();

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize(900, 900 );
				renderer.shadowMap.enabled = true;
				container.appendChild( renderer.domElement );
			}

			function loadButterfly () {
                // model
                var loader = new THREE.FBXLoader();
                loader.load( 'anim/butterfly_anim_v004.fbx', function ( object ) {
                    mixer = new THREE.AnimationMixer( object );
                    var action = mixer.clipAction( object.animations[ 0 ] );
                    action.play();
                    object.traverse( function ( child ) {
                        if ( child.isMesh ) {
                            child.castShadow = true;
                            child.receiveShadow = true;
                        } else if ( child instanceof THREE.Camera ) {
                            camera = child;
                        }
                    } );
					scene.add( object );
                } );
            }

			function animate() {
				requestAnimationFrame( animate );
				var delta = clock.getDelta();
				if ( mixer ) mixer.update( delta );

				camera.near = 0.01;
				camera.far = 10000;
				camera.updateProjectionMatrix();
				renderer.render( scene, camera );
			}
		</script>

	</body>
</html>
